<mxfile host="app.diagrams.net" agent="clean-rewrite" version="29.3.3">
  <diagram name="Clean-Arch" id="clean-ecs-arch">
    <mxGraphModel dx="1600" dy="900" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- ====== AWS Cloud / Region / VPC ====== -->
        <mxCell id="awsCloud" parent="1"
          style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];html=1;whiteSpace=wrap;fontSize=14;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_aws_cloud_alt;strokeColor=#232F3E;fillColor=none;verticalAlign=top;align=left;spacingLeft=30;fontColor=#232F3E;"
          value="AWS Cloud" vertex="1">
          <mxGeometry x="280" y="60" width="1040" height="760" as="geometry"/>
        </mxCell>

        <mxCell id="region" parent="awsCloud"
          style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];html=1;whiteSpace=wrap;fontSize=14;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_region;strokeColor=#00A4A6;fillColor=none;verticalAlign=top;align=left;spacingLeft=30;fontColor=#147EBA;dashed=1;"
          value="Region (e.g. eu-west-2)" vertex="1">
          <mxGeometry x="40" y="40" width="960" height="700" as="geometry"/>
        </mxCell>

        <mxCell id="vpc" parent="region"
          style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];html=1;whiteSpace=wrap;fontSize=14;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_vpc2;strokeColor=#8C4FFF;fillColor=none;verticalAlign=top;align=left;spacingLeft=30;fontColor=#AAB7B8;"
          value="VPC" vertex="1">
          <mxGeometry x="30" y="90" width="940" height="610" as="geometry"/>
        </mxCell>

        <!-- ====== Left side (Internet / CI/CD) ====== -->
        <mxCell id="users" parent="1"
          style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#232F3D;strokeColor=none;dashed=0;verticalLabelPosition=top;verticalAlign=bottom;align=center;html=1;fontSize=14;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.users;labelPosition=center;"
          value="Users" vertex="1">
          <mxGeometry x="40" y="120" width="80" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="internet" parent="1"
          style="ellipse;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=13;strokeColor=#232F3E;fillColor=none;"
          value="Internet&#xa;https://tm.yassinsuleiman.com" vertex="1">
          <mxGeometry x="25" y="260" width="130" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="route53" parent="1"
          style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#8C4FFF;strokeColor=#ffffff;dashed=0;verticalLabelPosition=top;verticalAlign=bottom;align=center;html=1;fontSize=13;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.route_53;labelPosition=center;"
          value="Route 53&#xa;(Hosted Zone)" vertex="1">
          <mxGeometry x="165" y="250" width="70" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="developer" parent="1"
          style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#232F3D;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.user;"
          value="Developer" vertex="1">
          <mxGeometry x="40" y="420" width="70" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="github" parent="1"
          style="dashed=0;outlineConnect=0;html=1;align=center;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;shape=mxgraph.weblogos.github;"
          value="GitHub Repo" vertex="1">
          <mxGeometry x="40" y="520" width="70" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="gha"
          parent="1"
          style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=13;strokeColor=#232F3E;fillColor=none;"
          value="GitHub Actions&#xa;(CI/CD)" vertex="1">
          <mxGeometry x="20" y="620" width="110" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="terraform"
          parent="1"
          style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=13;strokeColor=#232F3E;fillColor=none;"
          value="Terraform&#xa;(Plan/Apply/Destroy)" vertex="1">
          <mxGeometry x="10" y="700" width="130" height="70" as="geometry"/>
        </mxCell>

        <!-- Terraform state bucket -->
        <mxCell id="tfstate" parent="region"
          style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#7AA116;strokeColor=#ffffff;dashed=0;verticalLabelPosition=top;verticalAlign=bottom;align=center;html=1;fontSize=13;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.s3;labelPosition=center;"
          value="S3&#xa;TF State" vertex="1">
          <mxGeometry x="95" y="555" width="70" height="70" as="geometry"/>
        </mxCell>

        <!-- ECR -->
        <mxCell id="ecr" parent="region"
          style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#ED7100;strokeColor=#ffffff;dashed=0;verticalLabelPosition=top;verticalAlign=bottom;align=center;html=1;fontSize=13;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.ecr;labelPosition=center;"
          value="ECR&#xa;(Images)" vertex="1">
          <mxGeometry x="820" y="560" width="70" height="70" as="geometry"/>
        </mxCell>

        <!-- ====== Edge gateways inside VPC ====== -->
        <mxCell id="igw" parent="vpc"
          style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#8C4FFF;strokeColor=none;dashed=0;verticalLabelPosition=middle;verticalAlign=middle;align=left;html=1;fontSize=13;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.internet_gateway;labelPosition=right;"
          value="IGW" vertex="1">
          <mxGeometry x="20" y="250" width="58" height="58" as="geometry"/>
        </mxCell>

        <mxCell id="nat" parent="vpc"
          style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#8C4FFF;strokeColor=none;dashed=0;verticalLabelPosition=middle;verticalAlign=middle;align=left;html=1;fontSize=13;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.nat_gateway;labelPosition=right;"
          value="NAT Gateway&#xa;(one per AZ recommended)" vertex="1">
          <mxGeometry x="20" y="110" width="58" height="58" as="geometry"/>
        </mxCell>

        <!-- ====== Availability Zones (3 rows, consistent spacing) ====== -->
        <!-- Layout constants:
             AZ box: x=120, w=820, h=150
             Public subnet: x=140, w=240, h=110
             Private subnet: x=410, w=510, h=110
             Row y: 120 / 290 / 460
        -->

        <!-- AZ1 -->
        <mxCell id="az1" parent="vpc"
          style="fillColor=none;strokeColor=#147EBA;dashed=1;verticalAlign=top;fontStyle=0;fontColor=#147EBA;whiteSpace=wrap;html=1;fontSize=13;"
          value="Availability Zone A" vertex="1">
          <mxGeometry x="120" y="90" width="820" height="150" as="geometry"/>
        </mxCell>

        <mxCell id="pub1" parent="az1"
          style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];html=1;whiteSpace=wrap;fontSize=13;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_security_group;grStroke=0;strokeColor=#7AA116;fillColor=#F2F6E8;verticalAlign=top;align=left;spacingLeft=30;fontColor=#248814;"
          value="Public subnet" vertex="1">
          <mxGeometry x="20" y="30" width="240" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="alb"
          parent="pub1"
          style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#8C4FFF;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.application_load_balancer;"
          value="ALB&#xa;(Multi-AZ)" vertex="1">
          <mxGeometry x="85" y="25" width="64" height="64" as="geometry"/>
        </mxCell>

        <mxCell id="priv1" parent="az1"
          style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];html=1;whiteSpace=wrap;fontSize=13;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_security_group;grStroke=0;strokeColor=#00A4A6;fillColor=#E6F6F7;verticalAlign=top;align=left;spacingLeft=30;fontColor=#147EBA;"
          value="Private subnet" vertex="1">
          <mxGeometry x="290" y="30" width="510" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="task1"
          parent="priv1"
          style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.ecs_task;"
          value="ECS Task" vertex="1">
          <mxGeometry x="240" y="25" width="52" height="66" as="geometry"/>
        </mxCell>

        <!-- AZ2 -->
        <mxCell id="az2" parent="vpc"
          style="fillColor=none;strokeColor=#147EBA;dashed=1;verticalAlign=top;fontStyle=0;fontColor=#147EBA;whiteSpace=wrap;html=1;fontSize=13;"
          value="Availability Zone B" vertex="1">
          <mxGeometry x="120" y="260" width="820" height="150" as="geometry"/>
        </mxCell>

        <mxCell id="pub2" parent="az2"
          style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];html=1;whiteSpace=wrap;fontSize=13;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_security_group;grStroke=0;strokeColor=#7AA116;fillColor=#F2F6E8;verticalAlign=top;align=left;spacingLeft=30;fontColor=#248814;"
          value="Public subnet" vertex="1">
          <mxGeometry x="20" y="30" width="240" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="priv2" parent="az2"
          style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];html=1;whiteSpace=wrap;fontSize=13;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_security_group;grStroke=0;strokeColor=#00A4A6;fillColor=#E6F6F7;verticalAlign=top;align=left;spacingLeft=30;fontColor=#147EBA;"
          value="Private subnet" vertex="1">
          <mxGeometry x="290" y="30" width="510" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="task2"
          parent="priv2"
          style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.ecs_task;"
          value="ECS Task" vertex="1">
          <mxGeometry x="240" y="25" width="52" height="66" as="geometry"/>
        </mxCell>

        <!-- AZ3 -->
        <mxCell id="az3" parent="vpc"
          style="fillColor=none;strokeColor=#147EBA;dashed=1;verticalAlign=top;fontStyle=0;fontColor=#147EBA;whiteSpace=wrap;html=1;fontSize=13;"
          value="Availability Zone C" vertex="1">
          <mxGeometry x="120" y="430" width="820" height="150" as="geometry"/>
        </mxCell>

        <mxCell id="pub3" parent="az3"
          style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];html=1;whiteSpace=wrap;fontSize=13;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_security_group;grStroke=0;strokeColor=#7AA116;fillColor=#F2F6E8;verticalAlign=top;align=left;spacingLeft=30;fontColor=#248814;"
          value="Public subnet" vertex="1">
          <mxGeometry x="20" y="30" width="240" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="priv3" parent="az3"
          style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];html=1;whiteSpace=wrap;fontSize=13;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_security_group;grStroke=0;strokeColor=#00A4A6;fillColor=#E6F6F7;verticalAlign=top;align=left;spacingLeft=30;fontColor=#147EBA;"
          value="Private subnet" vertex="1">
          <mxGeometry x="290" y="30" width="510" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="task3"
          parent="priv3"
          style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.ecs_task;"
          value="ECS Task" vertex="1">
          <mxGeometry x="240" y="25" width="52" height="66" as="geometry"/>
        </mxCell>

        <!-- ====== ECS Service label (overlay group) ====== -->
        <mxCell id="ecsService" parent="vpc"
          style="fillColor=none;strokeColor=#D86613;dashed=0;verticalAlign=top;fontStyle=0;fontColor=#D86613;whiteSpace=wrap;html=1;fontSize=13;"
          value="ECS Service (Fargate)&#xa;Tasks spread across AZs" vertex="1">
          <mxGeometry x="720" y="105" width="210" height="470" as="geometry"/>
        </mxCell>

        <!-- ====== Connections ====== -->
        <mxCell id="e_users_internet" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="users" target="internet">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e_internet_r53" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="internet" target="route53">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e_r53_alb" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="route53" target="alb">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e_alb_task1" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="alb" target="task1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e_alb_task2" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="alb" target="task2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e_alb_task3" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="alb" target="task3">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e_igw_to_pub" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="igw" target="pub1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e_nat_to_priv" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="nat" target="priv1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e_dev_github" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="developer" target="github">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e_github_gha" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="github" target="gha">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e_gha_tf" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="gha" target="terraform">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e_tf_state" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="terraform" target="tfstate">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e_gha_ecr" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="gha" target="ecr">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e_ecr_tasks" parent="1" edge="1"
          style="endArrow=classic;html=1;rounded=0;fontSize=12;"
          source="ecr" target="task2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
